{% extends "navbar.html" %}
{% block top %}
<style>
    body { background:#060606; color:#e5e5e5; }
    .admin-wrapper { display:flex; margin-top:70px; min-height: calc(100vh - 70px); }
    .admin-sidebar { width:220px; background:#0c0c0c; border-right:1px solid #1c1c1c; padding:18px 14px; }
    .sidebar-title { font-size:20px; font-weight:700; margin:0 0 18px 2px; color:#e8e8e8; }
    .sidebar-nav { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:6px; }
    .sidebar-nav a { display:flex; align-items:center; gap:10px; padding:9px 10px; color:#d0d0d0; text-decoration:none; background:#111; border:1px solid #1f1f1f; border-radius:4px; transition:background .15s ease,color .15s ease, border .15s ease;}
    .sidebar-nav a:hover { background:#181818; color:#fff; border-color:#2a2a2a; }
    .sidebar-nav a.active { background:#202020; color:#fff; border-color:#3a3a3a; }
    .admin-content { flex:1; padding:0 24px 32px 24px; }
    .card { background:#0f0f0f; border:1px solid #1f1f1f; border-radius:4px; padding:14px 16px; margin-bottom:18px; }
    .muted { color:#9a9a9a; font-size:13px; }
    .form-grid { display:grid; grid-template-columns:1fr; gap:10px; }
    .form-grid input, .form-grid textarea, .form-grid select { width:100%; padding:10px; background:#111; border:1px solid #222; color:#fff; border-radius:3px; }
    .btn { background:#1c1c1c; border:1px solid #2a2a2a; color:#e6e6e6; padding:8px 12px; border-radius:3px; cursor:pointer; font-size:13px; }
    .btn:hover { background:#242424; border-color:#3a3a3a; }
    .ann-card { background:#141414; border:1px solid #222; border-radius:4px; padding:12px 14px; margin-bottom:12px; }
    .ann-title { font-weight:700; font-size:14px; margin-bottom:6px; }
    .ann-link { color:#2a9fd6; }
    .flex-row { display:flex; gap:8px; flex-wrap:wrap; }
    @media(max-width:900px){ .admin-wrapper{flex-direction:column;} .admin-sidebar{width:100%; border-right:none; border-bottom:1px solid #1c1c1c;} }
</style>
{% endblock %}

{% block bottom %}
<div class="admin-wrapper">
    <aside class="admin-sidebar">
        <div class="sidebar-title">ADMIN</div>
        <div class="muted" style="margin-bottom:12px;">Menu</div>
        <ul class="sidebar-nav">
            <li><a href="{{ url_for('index') }}"><span class="fa fa-home"></span>Home</a></li>
            <li><a href="{{ url_for('admin_dashboard') }}"><span class="fa fa-home"></span>HOA</a></li>
            <li><a href="{{ url_for('users') }}"><span class="fa fa-user"></span>Users</a></li>
            <li><a href="{{ url_for('admin_blacklist') }}"><span class="fa fa-ban"></span>Blacklist</a></li>
            <li><a href="{{ url_for('admin_flags') }}"><span class="fa fa-flag"></span>Flags</a></li>
            <li><a href="{{ url_for('admin_edits') }}"><span class="fa fa-edit"></span>Edits</a></li>
            <li><a href="{{ url_for('admin_logs') }}"><span class="fa fa-list"></span>Logs</a></li>
            <li><a href="{{ url_for('admin_spam') }}"><span class="fa fa-bell-slash"></span>Chat Mutes</a></li>
            <li><a href="{{ url_for('admin_gifts') }}"><span class="fa fa-gift"></span>Gifts</a></li>
            <li><a href="{{ url_for('admin_chat') }}"><span class="fa fa-commenting"></span>Chat</a></li>
            <li><a class="active" href="{{ url_for('admin_announcements') }}"><span class="fa fa-bullhorn"></span>Announcements</a></li>
            <li><a href="{{ url_for('settings') }}"><span class="fa fa-toggle-on"></span>Settings</a></li>
        </ul>
    </aside>

    <div class="admin-content">
        <div class="card">
            <h3 style="margin:0 0 6px 0;">Create Announcement</h3>
            <form method="post" class="form-grid">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <input type="hidden" name="action" value="create">
                <input type="text" name="title" placeholder="Title" required>
                <textarea name="body" placeholder="Text" required></textarea>
                <input type="text" name="link" placeholder="Link (optional)">
                <input type="text" name="color" value="#25ABEE" placeholder="Colour (hex)">
                <button class="btn" type="submit" style="max-width:140px;">CREATE</button>
            </form>
        </div>

        {% for a in announcements %}
        <div class="card ann-card">
            <div class="flex-row" style="justify-content:space-between; align-items:center;">
                <div class="ann-title">{{ a['title'] or 'Announcement' }} (ID {{ a['id'] }})</div>
                <form method="post" style="margin:0;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                    <input type="hidden" name="action" value="delete">
                    <input type="hidden" name="id" value="{{ a['id'] }}">
                    <button class="btn" type="submit" style="background:#3a1c1c;border-color:#4a2a2a;">Delete</button>
                </form>
            </div>
            <form method="post" class="form-grid" style="margin-top:8px;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <input type="hidden" name="action" value="update">
                <input type="hidden" name="id" value="{{ a['id'] }}">
                <input type="text" name="title" value="{{ a['title'] or '' }}" placeholder="Title">
                <textarea name="body" placeholder="Text">{{ a['body'] or '' }}</textarea>
                <input type="text" name="link" value="{{ a['link'] or '' }}" placeholder="Link">
                <input type="text" name="color" value="{{ a['color'] or '#25ABEE' }}">
                <div class="flex-row">
                    <span class="muted">Created: {{ a['created_at'] }}</span>
                    <button class="btn" type="submit">UPDATE</button>
                </div>
            </form>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
