{% extends "navbar.html" %}

{% block top %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Users</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background:#060606; color:#e5e5e5; font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; }
        .content { width:72%; max-width:900px; margin:36px auto 70px; color:#fff; }
        h1 { text-align:center; font-size:24px; font-weight:500; margin:0 0 14px 0; }
        .search-container { text-align:center; margin:4px 0 0 0; }
        .search-form { display:flex; justify-content:center; gap:6px; }
        .search-box {
            background:#131313;
            border:1px solid #222;
            outline:none;
            color:#fff;
            padding:7px 12px;
            width:270px;
            height:34px;
            box-sizing:border-box;
            font-size:13px;
        }
        .search-box::placeholder { color:#6f6f6f; }
        .search-button {
            background:#1b1b1b;
            color:#fff;
            border:1px solid #222;
            padding:7px 14px;
            cursor:pointer;
            height:34px;
            box-sizing:border-box;
            font-size:13px;
        }
        .search-button:hover { background:#222; }
        .showing-text { text-align:center; font-size:13px; margin:8px 0 18px; color:#777; }
        .rank-section { margin-bottom:24px; }
        .rank-section h2 { color:#fff; margin:12px 0 6px 0; padding:0; font-weight:600; font-size:16px; }
        table { width:100%; border-collapse:collapse; background:#0b0b0b; font-size:13px; table-layout:fixed; }
        th { padding:6px 8px; background:#161616; font-weight:700; border:none; border-bottom:1px solid #2b2b2b; color:#e5e5e5; text-align:left; }
        td { padding:6px 8px; border:none; border-bottom:1px solid #1a1a1a; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        tr { background:#0d0d0d; }
        tr:nth-child(even) { background:#121212; }
        a { color:inherit; text-decoration:underline; }
        td:first-child, th:first-child { width:14%; }
        td:nth-child(2), th:nth-child(2) { width:42%; }
        td:nth-child(3), th:nth-child(3) { width:14%; text-align:center; }
        td:nth-child(4), th:nth-child(4) { width:14%; text-align:center; }
        td:nth-child(5), th:nth-child(5) { width:16%; text-align:right; }
        .user-name {
            position:relative;
            font-weight:bold;
            text-decoration:underline;
            text-decoration-color: currentColor;
            text-decoration-thickness: 1px;
            display:inline-block;
            padding:0 2px 1px;
            background-repeat:no-repeat;
            background-position:center;
            background-size:cover;
            line-height:1.1;
        }
        .user-name .label { position:relative; z-index:2; }
        .no-users { text-align:left; font-weight:500; padding:9px 8px; color:#888; }
        @media (max-width: 768px) {
            .content { width:100%; margin:26px 0 36px; padding:0 10px; box-sizing:border-box; }
            table { font-size:12px; }
            td, th { padding:6px 6px; }
            th:nth-child(3), td:nth-child(3), th:nth-child(4), td:nth-child(4) { display:none; }
            td:first-child, th:first-child { width:22%; }
            td:nth-child(2), th:nth-child(2) { width:50%; }
            td:nth-child(5), th:nth-child(5) { width:28%; }
        }
    </style>
</head>
<body>
{% endblock %}

{% block bottom %}
<div class="content">
    <h1>Users</h1>
    <div class="search-container">
        <form class="search-form" method="get">
            <input class="search-box" type="text" name="q" placeholder="Username..." value="{{ q or '' }}" maxlength="20">
            <button class="search-button" type="submit">Search</button>
        </form>
    </div>
    <p class="showing-text">Showing {{ total }} users</p>

    {% for role in ["admin","founder","manager","mod","council","helper","clique","rich","vip","criminal","companion","fbi","user"] %}
        {% set list = grouped.get(role, []) %}
        <div class="rank-section">
            <h2>{{ role|capitalize }}</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Username</th>
                        <th>Pastes</th>
                        <th>Comments</th>
                        <th>Joined</th>
                    </tr>
                </thead>
                <tbody>
                    {% if list|length == 0 %}
                        <tr><td colspan="5" class="no-users">No users found in this rank.</td></tr>
                    {% else %}
                        {% for u in list %}
                            {% set deco = decorations.get(u['username'], {}) %}
                            {% set color = deco.get('color', '#2a9fd6') %}
                            {% set effect = deco.get('name_effect') %}
                            <tr>
                                <td>{{ u['id'] }}</td>
                                <td>
                                    <a class="user-name dox-username"{% if effect %} data-effect="1" style="color: {{ color }}; background-image:url('{{ effects.get(effect) }}');"{% else %} style="color: {{ color }};"{% endif %} href="{{ url_for('user_profile', username=u['username']) }}">
                                        <span class="label">{{ u['username'] }}</span>
                                    </a>
                                </td>
                                <td style="text-align:center;">{{ u['pastes'] }}</td>
                                <td style="text-align:center;">{{ u['comments'] }}</td>
                                <td>{{ u['datejoin'] }}</td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                </tbody>
            </table>
        </div>
    {% endfor %}
</div>
</body>
</html>
{% endblock %}
