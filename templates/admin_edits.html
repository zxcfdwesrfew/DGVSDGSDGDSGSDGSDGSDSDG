{% extends "navbar.html" %}
{% block top %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Edit Requests</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/legacy/index.css">
    <style>
        body { background:#060606; color:#e5e5e5; }
        .table-striped tbody>tr:nth-child(2n+1)>td { background:#171919; }
        .table-striped tbody>tr:nth-child(2n)>td { background:#0f0f0f; }
        .approved { color:#15c415; }
        .denied { color:#d22; }
        .pending { color:#e0c514; }
    </style>
</head>
<body>
{% endblock %}
{% block bottom %}
<div class="container" style="margin-top:70px;">
    <h4>Edit Requests</h4>
    <table class="table table-striped table-hover">
        <thead>
            <tr style="background:#3a3a3a;">
                <th>Paste</th>
                <th>Requested By</th>
                <th>Reason</th>
                <th>Status</th>
                <th>Requested At</th>
                <th>Decided At</th>
                <th>Decider</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for e in edits %}
            <tr>
                <td><a href="{{ url_for('post', file=e['pastname']) }}">{{ e['pastname'] }}</a></td>
                <td>{{ e['requester'] }}</td>
                <td>{{ e['reason'] }}</td>
                <td class="{% if e['status']=='approved' %}approved{% elif e['status']=='denied' %}denied{% else %}pending{% endif %}">{{ e['status']|capitalize }}</td>
                <td>{{ e['created_at'] }}</td>
                <td>{{ e['decided_at'] or '—' }}</td>
                <td>{{ e['decider'] or '—' }}</td>
                <td>
                    {% if e['status']=='pending' %}
                    <form method="post" action="{{ url_for('decide_edit', edit_id=e['id']) }}">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button name="decision" value="approved" class="btn btn-default">Approve</button>
                        <button name="decision" value="denied" class="btn btn-default">Deny</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
{% endblock %}
